<?php


namespace App\Controllers;
use Core\Auth;
use Core\View;

class Login extends \Core\Controller
{
    /**
     * Display login page
     */
    public function indexAction(){
        View::renderTemplate('Login/login.twig');
    }

    public function loginAction(){
        $user = Auth::authenticate($_POST['username'], $_POST['password']);
        $remember = isset($_POST['remember_me']);
        if($user){
            Auth::login($user, $remember);
            //remember the login

            $this->redirect(Auth::getReturnToPage());
        }else{
            $error = [
                'username_err'=>"Username or password is incorrect!",
                'password_err'=>"Username or password is incorrect!"
            ];
            View::renderTemplate('Login/login.twig', ['error'=>$error, 'username'=>$_POST['username']]);
        }
    }

    public function logoutAction(){
        Auth::logout();
        $this->redirect('/');
    }
}