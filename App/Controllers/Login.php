<?php


namespace App\Controllers;
use Core\Auth;
use Core\Flash;
use Core\View;

class Login extends \Core\Controller
{
    /**
     * Display login page
     */
    public function indexAction(){
        View::renderTemplate('Login/login.twig');
    }

    public function loginAction(){
        $user = Auth::authenticate($_POST['username'], $_POST['password']);
        $remember = isset($_POST['remember_me']);
        if($user){
            Auth::login($user, $remember);
            //remember the login

            $this->redirect(Auth::getReturnToPage());
        }else{
            Flash::addMessage("Username or password is incorrect!", Flash::WARNING);
            $this->redirect('/login');
        }
    }

    public function logoutAction(){
        Auth::logout();
        Flash::addMessage("Come back soon!", Flash::INFO);
        $this->redirect('/');
    }
}