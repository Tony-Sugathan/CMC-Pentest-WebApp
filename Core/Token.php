<?php


namespace Core;
/**
 * Class Token, used to create a remember token (user cookie)
 * and the hash of that token (stored in DB)
 *
 * When user login, create cookie with token generated
 *
 * When user visits some site, get the remembered logins info
 * from DB and attempts to login with it.
 * @package Core
 */

class Token
{
    /**
     * @var string
     */
    private $token;

    /**
     * Token constructor.
     * @param string $token
     */
    public function __construct($token = null)
    {
        if ($token) {

            $this->token = $token;

        } else {

            $this->token = bin2hex(random_bytes(16));  // 16 bytes = 128 bits = 32 hex characters
        }
    }

    /**
     * @return string
     */
    public function getToken(): string
    {
        return $this->token;
    }

    public function getHash(){
        return hash_hmac('sha256', $this->token, $_ENV['HASH_KEY']);
    }


}